"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[6628],{3905:(e,t,a)=>{a.d(t,{Zo:()=>m,kt:()=>k});var n=a(7294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function p(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function s(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?p(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):p(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},p=Object.keys(e);for(n=0;n<p.length;n++)a=p[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(e);for(n=0;n<p.length;n++)a=p[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var o=n.createContext({}),i=function(e){var t=n.useContext(o),a=t;return e&&(a="function"==typeof e?e(t):s(s({},t),e)),a},m=function(e){var t=i(e.components);return n.createElement(o.Provider,{value:t},e.children)},c="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},y=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,p=e.originalType,o=e.parentName,m=l(e,["components","mdxType","originalType","parentName"]),c=i(a),y=r,k=c["".concat(o,".").concat(y)]||c[y]||d[y]||p;return a?n.createElement(k,s(s({ref:t},m),{},{components:a})):n.createElement(k,s({ref:t},m))}));function k(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var p=a.length,s=new Array(p);s[0]=y;var l={};for(var o in t)hasOwnProperty.call(t,o)&&(l[o]=t[o]);l.originalType=e,l[c]="string"==typeof e?e:r,s[1]=l;for(var i=2;i<p;i++)s[i]=a[i];return n.createElement.apply(null,s)}return n.createElement.apply(null,a)}y.displayName="MDXCreateElement"},4283:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>m,contentTitle:()=>o,default:()=>k,frontMatter:()=>l,metadata:()=>i,toc:()=>c});var n=a(7462),r=a(3366),p=(a(7294),a(3905)),s=["components"],l={title:"Type Predicates"},o=void 0,i={unversionedId:"plugins/type_predicates",id:"plugins/type_predicates",title:"Type Predicates",description:"The typepredicates plugin adds predicate methods to",source:"@site/../doc/plugins/type_predicates.md",sourceDirName:"plugins",slug:"/plugins/type_predicates",permalink:"/docs/plugins/type_predicates",draft:!1,editUrl:"https://github.com/shrinerb/shrine/edit/master/doc/../doc/plugins/type_predicates.md",tags:[],version:"current",lastUpdatedBy:"Janko Marohni\u0107",lastUpdatedAt:1576588135,formattedLastUpdatedAt:"Dec 17, 2019",frontMatter:{title:"Type Predicates"},sidebar:"plugins",previous:{title:"Store Dimensions",permalink:"/docs/plugins/store_dimensions"},next:{title:"Download Endpoint",permalink:"/docs/plugins/download_endpoint"}},m={},c=[{value:"General predicates",id:"general-predicates",level:2},{value:"Specific predicates",id:"specific-predicates",level:2},{value:"MIME database",id:"mime-database",level:3}],d={toc:c},y="wrapper";function k(e){var t=e.components,a=(0,r.Z)(e,s);return(0,p.kt)(y,(0,n.Z)({},d,a,{components:t,mdxType:"MDXLayout"}),(0,p.kt)("p",null,"The ",(0,p.kt)("a",{parentName:"p",href:"https://github.com/shrinerb/shrine/blob/master/lib/shrine/plugins/type_predicates.rb"},(0,p.kt)("inlineCode",{parentName:"a"},"type_predicates"))," plugin adds predicate methods to\n",(0,p.kt)("inlineCode",{parentName:"p"},"Shrine::UploadedFile")," based on the MIME type. By default, it uses the\n",(0,p.kt)("a",{parentName:"p",href:"https://github.com/discourse/mini_mime"},"MiniMime")," gem for looking up MIME types."),(0,p.kt)("div",{"data-rehype-pretty-code-fragment":""},(0,p.kt)("pre",{parentName:"div","data-language":"rb","data-theme":"default"},(0,p.kt)("code",{parentName:"pre","data-language":"rb","data-theme":"default"},(0,p.kt)("span",{parentName:"code",className:"line"},(0,p.kt)("span",{parentName:"span",style:{color:"#7B7F8B"}},"# Gemfile")),"\n",(0,p.kt)("span",{parentName:"code",className:"line"},(0,p.kt)("span",{parentName:"span",style:{color:"#F6F6F4"}},"gem "),(0,p.kt)("span",{parentName:"span",style:{color:"#DEE492"}},'"'),(0,p.kt)("span",{parentName:"span",style:{color:"#E7EE98"}},"mini_mime"),(0,p.kt)("span",{parentName:"span",style:{color:"#DEE492"}},'"'))))),(0,p.kt)("div",{"data-rehype-pretty-code-fragment":""},(0,p.kt)("pre",{parentName:"div","data-language":"rb","data-theme":"default"},(0,p.kt)("code",{parentName:"pre","data-language":"rb","data-theme":"default"},(0,p.kt)("span",{parentName:"code",className:"line"},(0,p.kt)("span",{parentName:"span",style:{color:"#97E1F1",fontStyle:"italic"}},"Shrine"),(0,p.kt)("span",{parentName:"span",style:{color:"#F6F6F4"}},".plugin "),(0,p.kt)("span",{parentName:"span",style:{color:"#BF9EEE"}},":type_predicates"))))),(0,p.kt)("h2",{id:"general-predicates"},"General predicates"),(0,p.kt)("p",null,"The plugin adds four predicate methods based on the general type of the file:"),(0,p.kt)("div",{"data-rehype-pretty-code-fragment":""},(0,p.kt)("pre",{parentName:"div","data-language":"rb","data-theme":"default"},(0,p.kt)("code",{parentName:"pre","data-language":"rb","data-theme":"default"},(0,p.kt)("span",{parentName:"code",className:"line"},(0,p.kt)("span",{parentName:"span",style:{color:"#F6F6F4"}},"file.image? "),(0,p.kt)("span",{parentName:"span",style:{color:"#7B7F8B"}},'# returns true for any "image/*" MIME type')),"\n",(0,p.kt)("span",{parentName:"code",className:"line"},(0,p.kt)("span",{parentName:"span",style:{color:"#F6F6F4"}},"file.video? "),(0,p.kt)("span",{parentName:"span",style:{color:"#7B7F8B"}},'# returns true for any "video/*" MIME type')),"\n",(0,p.kt)("span",{parentName:"code",className:"line"},(0,p.kt)("span",{parentName:"span",style:{color:"#F6F6F4"}},"file.audio? "),(0,p.kt)("span",{parentName:"span",style:{color:"#7B7F8B"}},'# returns true for any "audio/*" MIME type')),"\n",(0,p.kt)("span",{parentName:"code",className:"line"},(0,p.kt)("span",{parentName:"span",style:{color:"#F6F6F4"}},"file.text?  "),(0,p.kt)("span",{parentName:"span",style:{color:"#7B7F8B"}},'# returns true for any "text/*" MIME type'))))),(0,p.kt)("p",null,"If ",(0,p.kt)("inlineCode",{parentName:"p"},"mime_type")," metadata value is nil, ",(0,p.kt)("inlineCode",{parentName:"p"},"Shrine::Error")," will be raised."),(0,p.kt)("h2",{id:"specific-predicates"},"Specific predicates"),(0,p.kt)("p",null,"The ",(0,p.kt)("inlineCode",{parentName:"p"},"UploadedFile#type?")," method takes a file extension, and returns whether the\n",(0,p.kt)("inlineCode",{parentName:"p"},"mime_type")," metadata value of the uploaded file matches the MIME type\nassociated to the given file extension."),(0,p.kt)("div",{"data-rehype-pretty-code-fragment":""},(0,p.kt)("pre",{parentName:"div","data-language":"rb","data-theme":"default"},(0,p.kt)("code",{parentName:"pre","data-language":"rb","data-theme":"default"},(0,p.kt)("span",{parentName:"code",className:"line"},(0,p.kt)("span",{parentName:"span",style:{color:"#F6F6F4"}},"file.type?("),(0,p.kt)("span",{parentName:"span",style:{color:"#BF9EEE"}},":jpg"),(0,p.kt)("span",{parentName:"span",style:{color:"#F6F6F4"}},") "),(0,p.kt)("span",{parentName:"span",style:{color:"#7B7F8B"}},'# returns true if MIME type is "image/jpeg"')),"\n",(0,p.kt)("span",{parentName:"code",className:"line"},(0,p.kt)("span",{parentName:"span",style:{color:"#F6F6F4"}},"file.type?("),(0,p.kt)("span",{parentName:"span",style:{color:"#BF9EEE"}},":svg"),(0,p.kt)("span",{parentName:"span",style:{color:"#F6F6F4"}},") "),(0,p.kt)("span",{parentName:"span",style:{color:"#7B7F8B"}},'# returns true if MIME type is "image/svg+xml"')),"\n",(0,p.kt)("span",{parentName:"code",className:"line"},(0,p.kt)("span",{parentName:"span",style:{color:"#F6F6F4"}},"file.type?("),(0,p.kt)("span",{parentName:"span",style:{color:"#BF9EEE"}},":mov"),(0,p.kt)("span",{parentName:"span",style:{color:"#F6F6F4"}},") "),(0,p.kt)("span",{parentName:"span",style:{color:"#7B7F8B"}},'# returns true if MIME type is "video/quicktime"')),"\n",(0,p.kt)("span",{parentName:"code",className:"line"},(0,p.kt)("span",{parentName:"span",style:{color:"#F6F6F4"}},"file.type?("),(0,p.kt)("span",{parentName:"span",style:{color:"#BF9EEE"}},":ppt"),(0,p.kt)("span",{parentName:"span",style:{color:"#F6F6F4"}},") "),(0,p.kt)("span",{parentName:"span",style:{color:"#7B7F8B"}},'# returns true if MIME type is "application/vnd.ms-powerpoint"')),"\n",(0,p.kt)("span",{parentName:"code",className:"line"},(0,p.kt)("span",{parentName:"span",style:{color:"#F6F6F4"}},"..."))))),(0,p.kt)("p",null,"For convenience, you can create predicate methods for specific file types:"),(0,p.kt)("div",{"data-rehype-pretty-code-fragment":""},(0,p.kt)("pre",{parentName:"div","data-language":"rb","data-theme":"default"},(0,p.kt)("code",{parentName:"pre","data-language":"rb","data-theme":"default"},(0,p.kt)("span",{parentName:"code",className:"line"},(0,p.kt)("span",{parentName:"span",style:{color:"#97E1F1",fontStyle:"italic"}},"Shrine"),(0,p.kt)("span",{parentName:"span",style:{color:"#F6F6F4"}},".plugin "),(0,p.kt)("span",{parentName:"span",style:{color:"#BF9EEE"}},":type_predicates"),(0,p.kt)("span",{parentName:"span",style:{color:"#F6F6F4"}},", methods"),(0,p.kt)("span",{parentName:"span",style:{color:"#F286C4"}},":"),(0,p.kt)("span",{parentName:"span",style:{color:"#F6F6F4"}}," "),(0,p.kt)("span",{parentName:"span",style:{color:"#F286C4"}},"%"),(0,p.kt)("span",{parentName:"span",style:{color:"#F6F6F4"}},"i[jpg svg mov ppt]"))))),(0,p.kt)("div",{"data-rehype-pretty-code-fragment":""},(0,p.kt)("pre",{parentName:"div","data-language":"rb","data-theme":"default"},(0,p.kt)("code",{parentName:"pre","data-language":"rb","data-theme":"default"},(0,p.kt)("span",{parentName:"code",className:"line"},(0,p.kt)("span",{parentName:"span",style:{color:"#F6F6F4"}},"file.jpg? "),(0,p.kt)("span",{parentName:"span",style:{color:"#7B7F8B"}},'# returns true if MIME type is "image/jpeg"')),"\n",(0,p.kt)("span",{parentName:"code",className:"line"},(0,p.kt)("span",{parentName:"span",style:{color:"#F6F6F4"}},"file.svg? "),(0,p.kt)("span",{parentName:"span",style:{color:"#7B7F8B"}},'# returns true if MIME type is "image/svg+xml"')),"\n",(0,p.kt)("span",{parentName:"code",className:"line"},(0,p.kt)("span",{parentName:"span",style:{color:"#F6F6F4"}},"file.mov? "),(0,p.kt)("span",{parentName:"span",style:{color:"#7B7F8B"}},'# returns true if MIME type is "video/quicktime"')),"\n",(0,p.kt)("span",{parentName:"code",className:"line"},(0,p.kt)("span",{parentName:"span",style:{color:"#F6F6F4"}},"file.ppt? "),(0,p.kt)("span",{parentName:"span",style:{color:"#7B7F8B"}},'# returns true if MIME type is "application/vnd.ms-powerpoint"'))))),(0,p.kt)("p",null,"If ",(0,p.kt)("inlineCode",{parentName:"p"},"mime_type")," metadata value is nil, or the underlying MIME type library\ndoesn't recognize a given type, ",(0,p.kt)("inlineCode",{parentName:"p"},"Shrine::Error")," will be raised."),(0,p.kt)("h3",{id:"mime-database"},"MIME database"),(0,p.kt)("p",null,"The MIME type lookup by file extension is done by the underlying MIME type\nlibrary (",(0,p.kt)("a",{parentName:"p",href:"https://github.com/discourse/mini_mime"},"MiniMime")," by default). You can change the MIME type library via the\n",(0,p.kt)("inlineCode",{parentName:"p"},":mime")," plugin option:"),(0,p.kt)("div",{"data-rehype-pretty-code-fragment":""},(0,p.kt)("pre",{parentName:"div","data-language":"rb","data-theme":"default"},(0,p.kt)("code",{parentName:"pre","data-language":"rb","data-theme":"default"},(0,p.kt)("span",{parentName:"code",className:"line"},(0,p.kt)("span",{parentName:"span",style:{color:"#97E1F1",fontStyle:"italic"}},"Shrine"),(0,p.kt)("span",{parentName:"span",style:{color:"#F6F6F4"}},".plugin "),(0,p.kt)("span",{parentName:"span",style:{color:"#BF9EEE"}},":type_predicates"),(0,p.kt)("span",{parentName:"span",style:{color:"#F6F6F4"}},", mime"),(0,p.kt)("span",{parentName:"span",style:{color:"#F286C4"}},":"),(0,p.kt)("span",{parentName:"span",style:{color:"#F6F6F4"}}," "),(0,p.kt)("span",{parentName:"span",style:{color:"#BF9EEE"}},":marcel"),(0,p.kt)("span",{parentName:"span",style:{color:"#F6F6F4"}}," "),(0,p.kt)("span",{parentName:"span",style:{color:"#7B7F8B"}},'# requires adding "marcel" gem to the Gemfile'))))),(0,p.kt)("p",null,"The following MIME type libraries are supported:"),(0,p.kt)("table",null,(0,p.kt)("thead",{parentName:"table"},(0,p.kt)("tr",{parentName:"thead"},(0,p.kt)("th",{parentName:"tr",align:"left"},"Name"),(0,p.kt)("th",{parentName:"tr",align:"left"},"Description"))),(0,p.kt)("tbody",{parentName:"table"},(0,p.kt)("tr",{parentName:"tbody"},(0,p.kt)("td",{parentName:"tr",align:"left"},(0,p.kt)("inlineCode",{parentName:"td"},":mini_mime")),(0,p.kt)("td",{parentName:"tr",align:"left"},"(",(0,p.kt)("strong",{parentName:"td"},"Default"),".) Uses ",(0,p.kt)("a",{parentName:"td",href:"https://github.com/discourse/mini_mime"},"MiniMime")," gem to look up MIME type by extension.")),(0,p.kt)("tr",{parentName:"tbody"},(0,p.kt)("td",{parentName:"tr",align:"left"},(0,p.kt)("inlineCode",{parentName:"td"},":mime_types")),(0,p.kt)("td",{parentName:"tr",align:"left"},"Uses ",(0,p.kt)("a",{parentName:"td",href:"https://github.com/mime-types/ruby-mime-types"},"mime-types")," gem to look up MIME type by extension.")),(0,p.kt)("tr",{parentName:"tbody"},(0,p.kt)("td",{parentName:"tr",align:"left"},(0,p.kt)("inlineCode",{parentName:"td"},":mimemagic")),(0,p.kt)("td",{parentName:"tr",align:"left"},"Uses ",(0,p.kt)("a",{parentName:"td",href:"https://github.com/minad/mimemagic"},"MimeMagic")," gem to look up MIME type by extension.")),(0,p.kt)("tr",{parentName:"tbody"},(0,p.kt)("td",{parentName:"tr",align:"left"},(0,p.kt)("inlineCode",{parentName:"td"},":marcel")),(0,p.kt)("td",{parentName:"tr",align:"left"},"Uses ",(0,p.kt)("a",{parentName:"td",href:"https://github.com/basecamp/marcel"},"Marcel")," gem to look up MIME type by extension.")),(0,p.kt)("tr",{parentName:"tbody"},(0,p.kt)("td",{parentName:"tr",align:"left"},(0,p.kt)("inlineCode",{parentName:"td"},":rack_mime")),(0,p.kt)("td",{parentName:"tr",align:"left"},"Uses ",(0,p.kt)("a",{parentName:"td",href:"https://github.com/rack/rack/blob/master/lib/rack/mime.rb"},"Rack::Mime")," to look up MIME type by extension.")))),(0,p.kt)("p",null,"You can also specify a custom block, which receives the extension and is\nexpected to return the corresponding MIME type. Inside the block you can call\ninto existing MIME type libraries:"),(0,p.kt)("div",{"data-rehype-pretty-code-fragment":""},(0,p.kt)("pre",{parentName:"div","data-language":"rb","data-theme":"default"},(0,p.kt)("code",{parentName:"pre","data-language":"rb","data-theme":"default"},(0,p.kt)("span",{parentName:"code",className:"line"},(0,p.kt)("span",{parentName:"span",style:{color:"#97E1F1",fontStyle:"italic"}},"Shrine"),(0,p.kt)("span",{parentName:"span",style:{color:"#F6F6F4"}},".plugin "),(0,p.kt)("span",{parentName:"span",style:{color:"#BF9EEE"}},":type_predicates"),(0,p.kt)("span",{parentName:"span",style:{color:"#F6F6F4"}},", mime"),(0,p.kt)("span",{parentName:"span",style:{color:"#F286C4"}},":"),(0,p.kt)("span",{parentName:"span",style:{color:"#F6F6F4"}}," "),(0,p.kt)("span",{parentName:"span",style:{color:"#97E1F1"}},"->"),(0,p.kt)("span",{parentName:"span",style:{color:"#F6F6F4"}}," (extension) "),(0,p.kt)("span",{parentName:"span",style:{color:"#F286C4"}},"do")),"\n",(0,p.kt)("span",{parentName:"code",className:"line"},(0,p.kt)("span",{parentName:"span",style:{color:"#F6F6F4"}},"  mime_type   "),(0,p.kt)("span",{parentName:"span",style:{color:"#F286C4"}},"="),(0,p.kt)("span",{parentName:"span",style:{color:"#F6F6F4"}}," "),(0,p.kt)("span",{parentName:"span",style:{color:"#97E1F1",fontStyle:"italic"}},"Shrine"),(0,p.kt)("span",{parentName:"span",style:{color:"#F6F6F4"}},".type_lookup(extension, "),(0,p.kt)("span",{parentName:"span",style:{color:"#BF9EEE"}},":marcel"),(0,p.kt)("span",{parentName:"span",style:{color:"#F6F6F4"}},")")),"\n",(0,p.kt)("span",{parentName:"code",className:"line"},(0,p.kt)("span",{parentName:"span",style:{color:"#F6F6F4"}},"  mime_type "),(0,p.kt)("span",{parentName:"span",style:{color:"#F286C4"}},"||="),(0,p.kt)("span",{parentName:"span",style:{color:"#F6F6F4"}}," "),(0,p.kt)("span",{parentName:"span",style:{color:"#97E1F1",fontStyle:"italic"}},"Shrine"),(0,p.kt)("span",{parentName:"span",style:{color:"#F6F6F4"}},".type_lookup(extension, "),(0,p.kt)("span",{parentName:"span",style:{color:"#BF9EEE"}},":mini_mime"),(0,p.kt)("span",{parentName:"span",style:{color:"#F6F6F4"}},")")),"\n",(0,p.kt)("span",{parentName:"code",className:"line"},(0,p.kt)("span",{parentName:"span",style:{color:"#F6F6F4"}},"  mime_type")),"\n",(0,p.kt)("span",{parentName:"code",className:"line"},(0,p.kt)("span",{parentName:"span",style:{color:"#F286C4"}},"end"))))))}k.isMDXComponent=!0}}]);